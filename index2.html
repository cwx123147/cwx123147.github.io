<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>图像对比</title>
  <style>
    body { margin: 0; padding: 20px; background: #fff; font-family: sans-serif; }
    .container {
      position: relative;
      width: 800px;
      height: 600px;
      max-width: 100%;
      margin: 0 auto;
      border: 1px solid #ddd;
    }
    .before, .after {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
    }
    .before {
      background-image: url('https://cwx123147.github.io/src_blur_0.jpg');
      clip-path: inset(0 50% 0 0); /* 默认显示左半 */
    }
    .after {
      background-image: url('https://cwx123147.github.io/dst_blur_0.jpg');
    }
    .slider {
      position: absolute;
      top: 0;
      left: 50%;
      width: 4px;
      height: 100%;
      background: white;
      box-shadow: -1px 0 0 rgba(0,0,0,0.3), 1px 0 0 rgba(0,0,0,0.3);
      cursor: ew-resize;
      z-index: 10;
    }
  </style>
</head>
<body>

<div class="container" id="compare">
  <div class="after"></div>
  <div class="before" id="before"></div>
  <div class="slider" id="slider"></div>
</div>

<script>
  const container = document.getElementById('compare');
  const before = document.getElementById('before');
  const slider = document.getElementById('slider');

  let isDragging = false;

  slider.addEventListener('mousedown', () => isDragging = true);
  window.addEventListener('mouseup', () => isDragging = false);
  window.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    const rect = container.getBoundingClientRect();
    let x = e.clientX - rect.left;
    x = Math.max(0, Math.min(x, rect.width));
    const percent = (x / rect.width) * 100;
    before.style.clipPath = `inset(0 ${100 - percent}% 0 0)`;
    slider.style.left = `${percent}%`;
  });

  // 移动端支持
  slider.addEventListener('touchstart', (e) => {
    isDragging = true;
    e.preventDefault();
  });
  window.addEventListener('touchend', () => isDragging = false);
  window.addEventListener('touchmove', (e) => {
    if (!isDragging) return;
    const rect = container.getBoundingClientRect();
    let x = e.touches[0].clientX - rect.left;
    x = Math.max(0, Math.min(x, rect.width));
    const percent = (x / rect.width) * 100;
    before.style.clipPath = `inset(0 ${100 - percent}% 0 0)`;
    slider.style.left = `${percent}%`;
    e.preventDefault();
  });
</script>

</body>
</html>
