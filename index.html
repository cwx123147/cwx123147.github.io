<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>图像对比（原图尺寸）</title>
  <style>
    /* 关键：重置 body，允许自然滚动 */
    html, body {
      margin: 0;
      padding: 20px;
      background: #f9f9f9;
      font-family: sans-serif;
      overflow: auto; /* 明确允许滚动 */
    }

    .container {
      position: relative;
      width: 3000px;   /* 原图宽度 */
      height: 4000px;  /* 原图高度 */
      border: 1px solid #ccc;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      overflow: visible;
      margin: 0 auto; /* 可选：水平居中（但不影响滚动） */
    }

    .before, .after {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: 3000px 4000px;
      background-repeat: no-repeat;
    }

    .before {
      background-image: url('https://cwx123147.github.io/noise_0.jpg');
      clip-path: inset(0 50% 0 0);
    }

    .after {
      background-image: url('https://cwx123147.github.io/output_noise_0.jpg');
    }

    .slider {
      position: absolute;
      top: 0;
      left: 50%;
      width: 4px;
      height: 100%;
      background: white;
      box-shadow: -1px 0 0 rgba(0,0,0,0.6), 1px 0 0 rgba(0,0,0,0.6);
      cursor: ew-resize;
      z-index: 10;
    }

    .tip {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.6);
      color: white;
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 12px;
      pointer-events: none;
    }
  </style>
</head>
<body>

<div class="container" id="compare">
  <div class="after"></div>
  <div class="before" id="before"></div>
  <div class="slider" id="slider"></div>
  <div class="tip">拖动白线左右滑动对比</div>
</div>

<script>
  const container = document.getElementById('compare');
  const before = document.getElementById('before');
  const slider = document.getElementById('slider');

  let isDragging = false;

  slider.addEventListener('mousedown', (e) => {
    isDragging = true;
    e.preventDefault();
  });
  window.addEventListener('mouseup', () => isDragging = false);
  window.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    const rect = container.getBoundingClientRect();
    let x = e.clientX - rect.left;
    x = Math.max(0, Math.min(x, rect.width));
    const percent = (x / rect.width) * 100;
    before.style.clipPath = `inset(0 ${100 - percent}% 0 0)`;
    slider.style.left = `${percent}%`;
  });

  // 移动端
  slider.addEventListener('touchstart', (e) => {
    isDragging = true;
    e.preventDefault();
  });
  window.addEventListener('touchend', () => isDragging = false);
  window.addEventListener('touchmove', (e) => {
    if (!isDragging) return;
    const rect = container.getBoundingClientRect();
    let x = e.touches[0].clientX - rect.left;
    x = Math.max(0, Math.min(x, rect.width));
    const percent = (x / rect.width) * 100;
    before.style.clipPath = `inset(0 ${100 - percent}% 0 0)`;
    slider.style.left = `${percent}%`;
    e.preventDefault();
  });
</script>

</body>
</html>
